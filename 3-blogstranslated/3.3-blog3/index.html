<!DOCTYPE html>
<html lang="en" class="js csstransforms3d">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="generator" content="Hugo 0.150.0">
    <meta
  name="description"
  content=""
/>
<meta name="author" content="thienlh@thienlu.com" />

    <link rel="icon" href="../../images/favicon.png" type="image/png">

    <title>Blog 3 :: Internship Report</title>

    
    <link href="../../css/nucleus.css?1765277002" rel="stylesheet">
    <link href="../../css/fontawesome-all.min.css?1765277002" rel="stylesheet">
    <link href="../../css/hybrid.css?1765277002" rel="stylesheet">
    <link href="../../css/featherlight.min.css?1765277002" rel="stylesheet">
    <link href="../../css/perfect-scrollbar.min.css?1765277002" rel="stylesheet">
    <link href="../../css/auto-complete.css?1765277002" rel="stylesheet">
    <link href="../../css/atom-one-dark-reasonable.css?1765277002" rel="stylesheet">
    <link href="../../css/theme.css?1765277002" rel="stylesheet">
    <link href="../../css/hugo-theme.css?1765277002" rel="stylesheet">
    
    <link href="../../css/theme-workshop.css?1765277002" rel="stylesheet">
    
    

    <script src="../../js/jquery-3.3.1.min.js?1765277002"></script>

    <style>
      :root #header + #content > #left > #rlblock_left{
          display:none !important;
      }
      
    </style>
    

  </head>
  <body class="" data-url="../../3-blogstranslated/3.3-blog3/">
    <nav id="sidebar" class="showVisitedLinks">
  
  

  <div id="header-wrapper">
    <div id="header"><a id="logo" href="../../">
  <svg
    id="Layer_1"
    data-name="Layer 1"
    xmlns="http://www.w3.org/2000/svg"
    viewBox="0 0 60 30"
    width="30%"
  >
    <defs>
      <style>
        .cls-1 {
          fill: #fff;
        }
        .cls-2 {
          fill: #f90;
          fill-rule: evenodd;
        }
      </style>
    </defs>
    <title>AWS-Logo_White-Color</title>
    <path
      class="cls-1"
      d="M14.09,10.85a4.7,4.7,0,0,0,.19,1.48,7.73,7.73,0,0,0,.54,1.19.77.77,0,0,1,.12.38.64.64,0,0,1-.32.49l-1,.7a.83.83,0,0,1-.44.15.69.69,0,0,1-.49-.23,3.8,3.8,0,0,1-.6-.77q-.25-.42-.51-1a6.14,6.14,0,0,1-4.89,2.3,4.54,4.54,0,0,1-3.32-1.19,4.27,4.27,0,0,1-1.22-3.2A4.28,4.28,0,0,1,3.61,7.75,6.06,6.06,0,0,1,7.69,6.46a12.47,12.47,0,0,1,1.76.13q.92.13,1.91.36V5.73a3.65,3.65,0,0,0-.79-2.66A3.81,3.81,0,0,0,7.86,2.3a7.71,7.71,0,0,0-1.79.22,12.78,12.78,0,0,0-1.79.57,4.55,4.55,0,0,1-.58.22l-.26,0q-.35,0-.35-.52V2a1.09,1.09,0,0,1,.12-.58,1.2,1.2,0,0,1,.47-.35A10.88,10.88,0,0,1,5.77.32,10.19,10.19,0,0,1,8.36,0a6,6,0,0,1,4.35,1.35,5.49,5.49,0,0,1,1.38,4.09ZM7.34,13.38a5.36,5.36,0,0,0,1.72-.31A3.63,3.63,0,0,0,10.63,12,2.62,2.62,0,0,0,11.19,11a5.63,5.63,0,0,0,.16-1.44v-.7a14.35,14.35,0,0,0-1.53-.28,12.37,12.37,0,0,0-1.56-.1,3.84,3.84,0,0,0-2.47.67A2.34,2.34,0,0,0,5,11a2.35,2.35,0,0,0,.61,1.76A2.4,2.4,0,0,0,7.34,13.38Zm13.35,1.8a1,1,0,0,1-.64-.16,1.3,1.3,0,0,1-.35-.65L15.81,1.51a3,3,0,0,1-.15-.67.36.36,0,0,1,.41-.41H17.7a1,1,0,0,1,.65.16,1.4,1.4,0,0,1,.33.65l2.79,11,2.59-11A1.17,1.17,0,0,1,24.39.6a1.1,1.1,0,0,1,.67-.16H26.4a1.1,1.1,0,0,1,.67.16,1.17,1.17,0,0,1,.32.65L30,12.39,32.88,1.25A1.39,1.39,0,0,1,33.22.6a1,1,0,0,1,.65-.16h1.54a.36.36,0,0,1,.41.41,1.36,1.36,0,0,1,0,.26,3.64,3.64,0,0,1-.12.41l-4,12.86a1.3,1.3,0,0,1-.35.65,1,1,0,0,1-.64.16H29.25a1,1,0,0,1-.67-.17,1.26,1.26,0,0,1-.32-.67L25.67,3.64,23.11,14.34a1.26,1.26,0,0,1-.32.67,1,1,0,0,1-.67.17Zm21.36.44a11.28,11.28,0,0,1-2.56-.29,7.44,7.44,0,0,1-1.92-.67,1,1,0,0,1-.61-.93v-.84q0-.52.38-.52a.9.9,0,0,1,.31.06l.42.17a8.77,8.77,0,0,0,1.83.58,9.78,9.78,0,0,0,2,.2,4.48,4.48,0,0,0,2.43-.55,1.76,1.76,0,0,0,.86-1.57,1.61,1.61,0,0,0-.45-1.16A4.29,4.29,0,0,0,43,9.22l-2.41-.76A5.15,5.15,0,0,1,38,6.78a3.94,3.94,0,0,1-.83-2.41,3.7,3.7,0,0,1,.45-1.85,4.47,4.47,0,0,1,1.19-1.37A5.27,5.27,0,0,1,40.51.29,7.4,7.4,0,0,1,42.6,0a8.87,8.87,0,0,1,1.12.07q.57.07,1.08.19t.95.26a4.27,4.27,0,0,1,.7.29,1.59,1.59,0,0,1,.49.41.94.94,0,0,1,.15.55v.79q0,.52-.38.52a1.76,1.76,0,0,1-.64-.2,7.74,7.74,0,0,0-3.2-.64,4.37,4.37,0,0,0-2.21.47,1.6,1.6,0,0,0-.79,1.48,1.58,1.58,0,0,0,.49,1.18,4.94,4.94,0,0,0,1.83.92L44.55,7a5.08,5.08,0,0,1,2.57,1.6A3.76,3.76,0,0,1,47.9,11a4.21,4.21,0,0,1-.44,1.93,4.4,4.4,0,0,1-1.21,1.47,5.43,5.43,0,0,1-1.85.93A8.25,8.25,0,0,1,42.05,15.62Z"
    ></path>
    <path
      class="cls-2"
      d="M45.19,23.81C39.72,27.85,31.78,30,25,30A36.64,36.64,0,0,1,.22,20.57c-.51-.46-.06-1.09.56-.74A49.78,49.78,0,0,0,25.53,26.4,49.23,49.23,0,0,0,44.4,22.53C45.32,22.14,46.1,23.14,45.19,23.81Z"
    ></path>
    <path
      class="cls-2"
      d="M47.47,21.21c-.7-.9-4.63-.42-6.39-.21-.53.06-.62-.4-.14-.74,3.13-2.2,8.27-1.57,8.86-.83s-.16,5.89-3.09,8.35c-.45.38-.88.18-.68-.32C46.69,25.8,48.17,22.11,47.47,21.21Z"
    ></path>
  </svg>
</a>
</div>
    
      <div class="searchbox">
    <label for="search-by"><i class="fas fa-search"></i></label>
    <input data-search-input id="search-by" type="search" placeholder="Search...">
    <span data-search-clear=""><i class="fas fa-times"></i></span>
</div>

<script type="text/javascript" src="../../js/lunr.min.js?1765277002"></script>
<script type="text/javascript" src="../../js/auto-complete.js?1765277002"></script>
<script type="text/javascript">
    
        var baseurl = "https:\/\/thienluhoan.github.io\/workshop-template\/";
    
</script>
<script type="text/javascript" src="../../js/search.js?1765277002"></script>

    
  </div>

  <div class="highlightable">
    <ul class="topics">
      
        
          







  
    
    <li
      data-nav-id="/1-worklog/"
      title="Worklog"
      class="dd-item
        
        
        "
    >
      <a href="../../1-worklog/">
         <b> 1. </b> Worklog
        
          <i class="fas fa-check read-icon"></i>
        
      </a>

      
      
        <ul>
          
          
            
          
          

          
            
              
                







  
    
    <li
      data-nav-id="/1-worklog/1.3-week3/"
      title="Week 3 Worklog"
      class="dd-item
        
        
        "
    >
      <a href="../../1-worklog/1.3-week3/">
         <b> 1.3. </b> Week 3 Worklog
        
          <i class="fas fa-check read-icon"></i>
        
      </a>

      
      
    </li>
  


              
            
              
                







  
    
    <li
      data-nav-id="/1-worklog/1.4-week4/"
      title="Week 4 Worklog"
      class="dd-item
        
        
        "
    >
      <a href="../../1-worklog/1.4-week4/">
         <b> 1.4. </b> Week 4 Worklog
        
          <i class="fas fa-check read-icon"></i>
        
      </a>

      
      
    </li>
  


              
            
              
                







  
    
    <li
      data-nav-id="/1-worklog/1.5-week5/"
      title="Week 5 Worklog"
      class="dd-item
        
        
        "
    >
      <a href="../../1-worklog/1.5-week5/">
         <b> 1.5. </b> Week 5 Worklog
        
          <i class="fas fa-check read-icon"></i>
        
      </a>

      
      
    </li>
  


              
            
              
                







  
    
    <li
      data-nav-id="/1-worklog/1.6-week6/"
      title="Week 6 Worklog"
      class="dd-item
        
        
        "
    >
      <a href="../../1-worklog/1.6-week6/">
         <b> 1.6. </b> Week 6 Worklog
        
          <i class="fas fa-check read-icon"></i>
        
      </a>

      
      
    </li>
  


              
            
              
                







  
    
    <li
      data-nav-id="/1-worklog/1.7-week7/"
      title="Week 7 Worklog"
      class="dd-item
        
        
        "
    >
      <a href="../../1-worklog/1.7-week7/">
         <b> 1.7. </b> Week 7 Worklog
        
          <i class="fas fa-check read-icon"></i>
        
      </a>

      
      
    </li>
  


              
            
              
                







  
    
    <li
      data-nav-id="/1-worklog/1.8-week8/"
      title="Week 8 Worklog"
      class="dd-item
        
        
        "
    >
      <a href="../../1-worklog/1.8-week8/">
         <b> 1.8. </b> Week 8 Worklog
        
          <i class="fas fa-check read-icon"></i>
        
      </a>

      
      
    </li>
  


              
            
              
                







  
    
    <li
      data-nav-id="/1-worklog/1.9-week9/"
      title="Week 9 Worklog"
      class="dd-item
        
        
        "
    >
      <a href="../../1-worklog/1.9-week9/">
         <b> 1.9. </b> Week 9 Worklog
        
          <i class="fas fa-check read-icon"></i>
        
      </a>

      
      
    </li>
  


              
            
              
                







  
    
    <li
      data-nav-id="/1-worklog/1.2-week2/"
      title="Week 2 Worklog"
      class="dd-item
        
        
        "
    >
      <a href="../../1-worklog/1.2-week2/">
         <b> 1.2. </b> Week 2 Worklog
        
          <i class="fas fa-check read-icon"></i>
        
      </a>

      
      
    </li>
  


              
            
              
                







  
    
    <li
      data-nav-id="/1-worklog/1.1-week1/"
      title="Week 1 Worklog"
      class="dd-item
        
        
        "
    >
      <a href="../../1-worklog/1.1-week1/">
         <b> 1.1. </b> Week 1 Worklog
        
          <i class="fas fa-check read-icon"></i>
        
      </a>

      
      
    </li>
  


              
            
              
                







  
    
    <li
      data-nav-id="/1-worklog/1.10-week10/"
      title="Week 10 Worklog"
      class="dd-item
        
        
        "
    >
      <a href="../../1-worklog/1.10-week10/">
         <b> 1.10. </b> Week 10 Worklog
        
          <i class="fas fa-check read-icon"></i>
        
      </a>

      
      
    </li>
  


              
            
              
                







  
    
    <li
      data-nav-id="/1-worklog/1.11-week11/"
      title="Week 11 Worklog"
      class="dd-item
        
        
        "
    >
      <a href="../../1-worklog/1.11-week11/">
         <b> 1.11. </b> Week 11 Worklog
        
          <i class="fas fa-check read-icon"></i>
        
      </a>

      
      
    </li>
  


              
            
              
                







  
    
    <li
      data-nav-id="/1-worklog/1.12-week12/"
      title="Week 12 Worklog"
      class="dd-item
        
        
        "
    >
      <a href="../../1-worklog/1.12-week12/">
         <b> 1.12. </b> Week 12 Worklog
        
          <i class="fas fa-check read-icon"></i>
        
      </a>

      
      
    </li>
  


              
            
          
        </ul>
      
    </li>
  


        
          







  
    
    <li
      data-nav-id="/2-proposal/"
      title="Proposal"
      class="dd-item
        
        
        "
    >
      <a href="../../2-proposal/">
         <b> 2. </b> Proposal
        
          <i class="fas fa-check read-icon"></i>
        
      </a>

      
      
    </li>
  


        
          







  
    
    <li
      data-nav-id="/3-blogstranslated/"
      title="Translated Blogs"
      class="dd-item
        parent
        
        "
    >
      <a href="../../3-blogstranslated/">
         <b> 3. </b> Translated Blogs
        
          <i class="fas fa-check read-icon"></i>
        
      </a>

      
      
        <ul>
          
          
            
          
          

          
            
              
                







  
    
    <li
      data-nav-id="/3-blogstranslated/3.1-blog1/"
      title="Blog 1"
      class="dd-item
        
        
        "
    >
      <a href="../../3-blogstranslated/3.1-blog1/">
         <b> 3.1. </b> Blog 1
        
          <i class="fas fa-check read-icon"></i>
        
      </a>

      
      
    </li>
  


              
            
              
                







  
    
    <li
      data-nav-id="/3-blogstranslated/3.2-blog2/"
      title="Blog 2"
      class="dd-item
        
        
        "
    >
      <a href="../../3-blogstranslated/3.2-blog2/">
         <b> 3.2. </b> Blog 2
        
          <i class="fas fa-check read-icon"></i>
        
      </a>

      
      
    </li>
  


              
            
              
                







  
    
    <li
      data-nav-id="/3-blogstranslated/3.3-blog3/"
      title="Blog 3"
      class="dd-item
        
        active
        "
    >
      <a href="../../3-blogstranslated/3.3-blog3/">
         <b> 3.3. </b> Blog 3
        
          <i class="fas fa-check read-icon"></i>
        
      </a>

      
      
    </li>
  


              
            
          
        </ul>
      
    </li>
  


        
          







  
    
    <li
      data-nav-id="/4-eventparticipated/"
      title="Events Participated"
      class="dd-item
        
        
        "
    >
      <a href="../../4-eventparticipated/">
         <b> 4. </b> Events Participated
        
          <i class="fas fa-check read-icon"></i>
        
      </a>

      
      
        <ul>
          
          
            
          
          

          
            
              
                







  
    
    <li
      data-nav-id="/4-eventparticipated/4.5-event5/"
      title="Event 5"
      class="dd-item
        
        
        "
    >
      <a href="../../4-eventparticipated/4.5-event5/">
         <b> 4.5. </b> Event 5
        
          <i class="fas fa-check read-icon"></i>
        
      </a>

      
      
    </li>
  


              
            
              
                







  
    
    <li
      data-nav-id="/4-eventparticipated/4.4-event4/"
      title="Event 4"
      class="dd-item
        
        
        "
    >
      <a href="../../4-eventparticipated/4.4-event4/">
         <b> 4.4. </b> Event 4
        
          <i class="fas fa-check read-icon"></i>
        
      </a>

      
      
    </li>
  


              
            
              
                







  
    
    <li
      data-nav-id="/4-eventparticipated/4.3-event3/"
      title="Event 3"
      class="dd-item
        
        
        "
    >
      <a href="../../4-eventparticipated/4.3-event3/">
         <b> 4.3. </b> Event 3
        
          <i class="fas fa-check read-icon"></i>
        
      </a>

      
      
    </li>
  


              
            
              
                







  
    
    <li
      data-nav-id="/4-eventparticipated/4.2-event2/"
      title="Event 2"
      class="dd-item
        
        
        "
    >
      <a href="../../4-eventparticipated/4.2-event2/">
         <b> 4.2. </b> Event 2
        
          <i class="fas fa-check read-icon"></i>
        
      </a>

      
      
    </li>
  


              
            
              
                







  
    
    <li
      data-nav-id="/4-eventparticipated/4.1-event1/"
      title="Event 1"
      class="dd-item
        
        
        "
    >
      <a href="../../4-eventparticipated/4.1-event1/">
         <b> 4.1. </b> Event 1
        
          <i class="fas fa-check read-icon"></i>
        
      </a>

      
      
    </li>
  


              
            
          
        </ul>
      
    </li>
  


        
          







  
    
    <li
      data-nav-id="/5-workshop/"
      title="Workshop"
      class="dd-item
        
        
        "
    >
      <a href="../../5-workshop/">
         <b> 5. </b> Workshop
        
          <i class="fas fa-check read-icon"></i>
        
      </a>

      
      
        <ul>
          
          
            
          
          

          
            
              
                







  
    
    <li
      data-nav-id="/5-workshop/5.1-workshop-overview/"
      title="Introduction"
      class="dd-item
        
        
        "
    >
      <a href="../../5-workshop/5.1-workshop-overview/">
         <b> 5.1. </b> Introduction
        
          <i class="fas fa-check read-icon"></i>
        
      </a>

      
      
    </li>
  


              
            
              
                







  
    
    <li
      data-nav-id="/5-workshop/5.2-prerequiste/"
      title="Prerequiste"
      class="dd-item
        
        
        "
    >
      <a href="../../5-workshop/5.2-prerequiste/">
         <b> 5.2. </b> Prerequiste
        
          <i class="fas fa-check read-icon"></i>
        
      </a>

      
      
    </li>
  


              
            
              
                







  
    
    <li
      data-nav-id="/5-workshop/5.3-create-amplify/"
      title="Create Amplify backend"
      class="dd-item
        
        
        "
    >
      <a href="../../5-workshop/5.3-create-amplify/">
         <b> 5.3. </b> Create Amplify backend
        
          <i class="fas fa-check read-icon"></i>
        
      </a>

      
      
    </li>
  


              
            
              
                







  
    
    <li
      data-nav-id="/5-workshop/5.4-aws-cognito/"
      title="Configure AWS Cognito"
      class="dd-item
        
        
        "
    >
      <a href="../../5-workshop/5.4-aws-cognito/">
          5.4.  Configure AWS Cognito
        
          <i class="fas fa-check read-icon"></i>
        
      </a>

      
      
    </li>
  


              
            
              
                







  
    
    <li
      data-nav-id="/5-workshop/5.5-create-ses/"
      title="Configure Amazon SES for email"
      class="dd-item
        
        
        "
    >
      <a href="../../5-workshop/5.5-create-ses/">
         <b> 5.5. </b> Configure Amazon SES for email
        
          <i class="fas fa-check read-icon"></i>
        
      </a>

      
      
    </li>
  


              
            
              
                







  
    
    <li
      data-nav-id="/5-workshop/5.6-create-cloudwatch/"
      title="Configure Amazon CloudWatch"
      class="dd-item
        
        
        "
    >
      <a href="../../5-workshop/5.6-create-cloudwatch/">
         <b> 5.6. </b> Configure Amazon CloudWatch
        
          <i class="fas fa-check read-icon"></i>
        
      </a>

      
      
    </li>
  


              
            
              
                







  
    
    <li
      data-nav-id="/5-workshop/5.7-create-iam-roles-policies/"
      title="Create IAM Roles-Policies"
      class="dd-item
        
        
        "
    >
      <a href="../../5-workshop/5.7-create-iam-roles-policies/">
         <b> 5.7. </b> Create IAM Roles-Policies
        
          <i class="fas fa-check read-icon"></i>
        
      </a>

      
      
    </li>
  


              
            
              
                







  
    
    <li
      data-nav-id="/5-workshop/5.8-route-53/"
      title="Configure Amazon Route 53"
      class="dd-item
        
        
        "
    >
      <a href="../../5-workshop/5.8-route-53/">
         <b> 5.8. </b> Configure Amazon Route 53
        
          <i class="fas fa-check read-icon"></i>
        
      </a>

      
      
    </li>
  


              
            
              
                







  
    
    <li
      data-nav-id="/5-workshop/5.9-cleanup/"
      title="Clean up"
      class="dd-item
        
        
        "
    >
      <a href="../../5-workshop/5.9-cleanup/">
         <b> 5.9. </b> Clean up
        
          <i class="fas fa-check read-icon"></i>
        
      </a>

      
      
    </li>
  


              
            
          
        </ul>
      
    </li>
  


        
          







  
    
    <li
      data-nav-id="/6-self-evaluation/"
      title="Self-Assessment"
      class="dd-item
        
        
        "
    >
      <a href="../../6-self-evaluation/">
         <b> 6. </b> Self-Assessment
        
          <i class="fas fa-check read-icon"></i>
        
      </a>

      
      
    </li>
  


        
          







  
    
    <li
      data-nav-id="/7-feedback/"
      title="Sharing and Feedback"
      class="dd-item
        
        
        "
    >
      <a href="../../7-feedback/">
         <b> 7. </b> Sharing and Feedback
        
          <i class="fas fa-check read-icon"></i>
        
      </a>

      
      
    </li>
  


        
      
    </ul>

    
    
      <section id="shortcuts">
        <h3>More</h3>
        <ul>
          
            <li>
              <a class="padding" href="https://www.facebook.com/groups/awsstudygroupfcj/"><i class='fab fa-facebook'></i> AWS Study Group</a>
            </li>
          
        </ul>
      </section>
    

    
      <section id="prefooter">
        <hr />
        <ul>
          
            <li>
              <a class="padding">
                <i class="fas fa-language fa-fw"></i>
                <div class="select-style">
                  <select id="select-language" onchange="location = this.value;">
                    
                    

                    
                      
                      
                        
                          
                            <option value="https://thienluhoan.github.io/workshop-template/3-blogstranslated/3.3-blog3/" selected>English</option>
                          
                        
                      
                        
                      
                    
                      
                      
                        
                      
                        
                          
                            <option value="https://thienluhoan.github.io/workshop-template/vi/3-blogstranslated/3.3-blog3/">Tiếng Việt</option>
                          
                        
                      
                    

                  </select>
                  
                  <svg version="1.1" id="Capa_1" xmlns="http://www.w3.org/2000/svg" x="0px" y="0px" width="255px" height="255px" viewBox="0 0 255 255" xml:space="preserve">
                    <g><g id="arrow-drop-down"><polygon points="0,63.75 127.5,191.25 255,63.75"/></g></g>
                  </svg>
                </div>
              </a>
            </li>
          

          
            <li>
              <a class="padding" href="#" data-clear-history-toggle="">
                <i class="fas fa-history fa-fw"></i> Clear History
              </a>
            </li>
          
        </ul>
      </section>
    

    <section id="footer"><left>
    
    <b> Workshop</b> <br>
    <img src="https://hitwebcounter.com/counter/counter.php?page=7920860&style=0038&nbdigits=9&type=page&initCount=0"
        title="Migrate" Alt="web counter" border="0" /></a> <br>
    <b> <a href="https://cloudjourney.awsstudygroup.com/">Cloud Journey</a></b> <br>
    <img src="https://hitwebcounter.com/counter/counter.php?page=7830807&style=0038&nbdigits=9&type=page&initCount=0"
        title="Total CLoud Journey" Alt="web counter" border="0" />

</left>
<left>
    <br>
    <br>
    <b>Last Updated</b><br>
    <i>
        <span id="lastUpdated" style="color:orange;"></span>
    </i>

    <script>
        
        const today = new Date();
        
        const formattedDate = today.toLocaleDateString('en-GB');
        
        document.getElementById('lastUpdated').textContent = formattedDate;
    </script>
</left>
<left>
    <br>
    <br>
    <b> Team </b> <br>

    <i> <a href="https://www.facebook.com/groups/660548818043427" style="color:orange">First Cloud Journey </a> <br>

    </i>
</left>

<script async defer src="https://buttons.github.io/buttons.js"></script>
</section>
  </div>
</nav>

        <section id="body">
        <div id="overlay"></div>
        <div class="padding highlightable">
              
              <div>
                <div id="top-bar">
                
                
                <div id="breadcrumbs" itemscope="" itemtype="http://data-vocabulary.org/Breadcrumb">
                    <span id="sidebar-toggle-span">
                        <a href="#" id="sidebar-toggle" data-sidebar-toggle="">
                          <i class="fas fa-bars"></i>
                        </a>
                    </span>
                  
                  <span id="toc-menu"><i class="fas fa-list-alt"></i></span>
                  
                  <span class="links">
                 
                 
                    
          
          
            
            
          
          
            
            
          
          
            <a href='../../'>Internship Report</a> > <a href='../../3-blogstranslated/'>Translated Blogs</a> > Blog 3
          
        
          
        
          
        
                 
                  </span>
                </div>
                
                    <div class="progress">
  <div class="wrapper"><nav id="TableOfContents">
  <ul>
    <li><a href="#getting-started-with-apache-ofbiz-and-amazon-aurora-dsql">Getting Started with Apache OFBiz and Amazon Aurora DSQL</a></li>
    <li><a href="#the-application">The Application</a></li>
    <li><a href="#aurora-dsql">Aurora DSQL</a></li>
    <li><a href="#creating-a-data-source-configuration-for-aurora-dsql">Creating a Data Source Configuration for Aurora DSQL</a>
      <ul>
        <li><a href="#implementing-connection-logic-for-aurora-dsql">Implementing Connection Logic for Aurora DSQL</a></li>
        <li><a href="#schema-adjustments">Schema Adjustments</a></li>
        <li><a href="#loading-demo-data">Loading Demo Data</a></li>
      </ul>
    </li>
    <li><a href="#conclusion">Conclusion</a></li>
  </ul>
</nav></div>
</div>

                
              </div>
            </div>
            
        <div id="head-tags">
        

        </div>
        
        <div id="body-inner">
          
            <h1>
              
              Blog 3
            </h1>
          

        



	<h1 id="aws-database-blog">AWS Database Blog</h1>
<h2 id="getting-started-with-apache-ofbiz-and-amazon-aurora-dsql">Getting Started with Apache OFBiz and Amazon Aurora DSQL</h2>
<p><strong>Author:</strong> James Morle | <strong>Date:</strong> March 26, 2025 | <strong>Categories:</strong> Advanced (300), Amazon Aurora, Best Practices, DSQL, Technical How-to</p>
<hr>
<p>When designing Amazon Aurora DSQL, we spent a lot of time finding the right balance between innovation and improvements versus ease of use. We did not want to change what was familiar to existing PostgreSQL users unless there was a truly compelling reason. Two areas in this group are optimistic concurrency control (OCC) behavior and the authentication model, where system behavior might feel different to application developers familiar with PostgreSQL.</p>
<p>In this article, we present a practical example of migrating an existing application originally running on PostgreSQL to operate with Aurora DSQL. Along with adjustments to adapt to the mentioned aspects, we also handle some data type incompatibilities and work around a few current limitations in Aurora DSQL.</p>
<hr>
<h2 id="the-application">The Application</h2>
<p>To make this example as representative as possible, we chose an open-source application with a broad functional scope and significant complexity, reflecting real-world applications. That application is Apache OFBiz, and the source code can be downloaded from the GitHub repository. The version used in this proof of concept is 18.12.16.</p>
<p>The OFBiz application is a full-featured ERP and CRM suite, serving as a typical target for our goals here:</p>
<ul>
<li>Complex schema: 837 tables, 4161 indexes</li>
<li>Abstract entity engine (Java Persistence, Java Transactions, custom ORM)</li>
<li>PostgreSQL support</li>
<li>Built-in demo data and data loading functionality</li>
<li>Mostly relational model, aligned with Aurora DSQL’s initial compatibility focus</li>
</ul>
<p>The purpose of this article is to combine a description of the internal testing process with some specific code examples on how to approach Aurora DSQL authentication in a connection pool–based Java application. While we provide as much context as possible, this is not intended to be a full script or complete codebase for replicating the entire process.</p>
<hr>
<h2 id="aurora-dsql">Aurora DSQL</h2>
<p>Aurora DSQL is a PostgreSQL-compatible database with some semantic differences aimed at improving scalability and security compared to community PostgreSQL. Some aspects, especially broad functional compatibility with PostgreSQL features, will evolve rapidly over time, but a few core elements define the system. These are the focus of the changes made in the OFBiz application and presented in this article. These include:</p>
<ul>
<li>Aurora DSQL authentication model — How connections are established and maintained.</li>
<li>Transaction size limits — Aurora DSQL does not support unlimited transaction sizes.</li>
<li>Isolation level — Aurora DSQL only supports snapshot isolation, equivalent to repeatable read in PostgreSQL.</li>
<li>Optimistic concurrency control — Aurora DSQL does not lock resources during transaction construction; it guarantees consistency at commit time. This means some commits may fail and require retries.</li>
<li>Data type limitations in keys — Currently, there are some limits on data types (and sizes) supported in primary and foreign keys. These limits will decrease over time as Aurora DSQL adds new supported types. The workarounds presented reflect the limits present in the Aurora DSQL Preview stage.</li>
</ul>
<hr>
<h2 id="creating-a-data-source-configuration-for-aurora-dsql">Creating a Data Source Configuration for Aurora DSQL</h2>
<p>The first step was to define a new data source configuration for Aurora DSQL. We added a new data source named <code>localdsql</code> in the <code>framework/entity/config/entityengine.xml</code> file and set it as the active data source. Parameters were copied from the existing <code>localpostgres</code> data source, with the following key differences underlined:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-xml" data-lang="xml"><span style="display:flex;"><span><span style="color:#f92672">&lt;group-map</span> <span style="color:#a6e22e">group-name=</span><span style="color:#e6db74">&#34;org.apache.ofbiz&#34;</span> <span style="color:#a6e22e">datasource-name=</span><span style="color:#e6db74">&#34;localdsql&#34;</span><span style="color:#f92672">/&gt;</span>
</span></span><span style="display:flex;"><span>...
</span></span><span style="display:flex;"><span><span style="color:#f92672">&lt;/datasource&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">&lt;datasource</span> <span style="color:#a6e22e">name=</span><span style="color:#e6db74">&#34;localdsql&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">helper-class=</span><span style="color:#e6db74">&#34;org.apache.ofbiz.entity.datasource.GenericHelperDAO&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">schema-name=</span><span style="color:#e6db74">&#34;ofbiz&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">field-type-name=</span><span style="color:#e6db74">&#34;postgres&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">check-on-start=</span><span style="color:#e6db74">&#34;true&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">add-missing-on-start=</span><span style="color:#e6db74">&#34;true&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">use-fk-initially-deferred=</span><span style="color:#e6db74">&#34;false&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">alias-view-columns=</span><span style="color:#e6db74">&#34;false&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">join-style=</span><span style="color:#e6db74">&#34;ansi&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">use-binary-type-for-blob=</span><span style="color:#e6db74">&#34;true&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">use-order-by-nulls=</span><span style="color:#e6db74">&#34;true&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">result-fetch-size=</span><span style="color:#e6db74">&#34;50&#34;</span><span style="color:#f92672">&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&lt;read-data</span> <span style="color:#a6e22e">reader-name=</span><span style="color:#e6db74">&#34;tenant&#34;</span><span style="color:#f92672">/&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&lt;read-data</span> <span style="color:#a6e22e">reader-name=</span><span style="color:#e6db74">&#34;seed&#34;</span><span style="color:#f92672">/&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&lt;read-data</span> <span style="color:#a6e22e">reader-name=</span><span style="color:#e6db74">&#34;seed-initial&#34;</span><span style="color:#f92672">/&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&lt;group-map</span> <span style="color:#a6e22e">group-name=</span><span style="color:#e6db74">&#34;org.apache.ofbiz&#34;</span> <span style="color:#a6e22e">datasource-name=</span><span style="color:#e6db74">&#34;localdsql&#34;</span><span style="color:#f92672">/&gt;</span>
</span></span><span style="display:flex;"><span>...
</span></span><span style="display:flex;"><span><span style="color:#f92672">&lt;/datasource&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">&lt;datasource</span> <span style="color:#a6e22e">name=</span><span style="color:#e6db74">&#34;localdsql&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">helper-class=</span><span style="color:#e6db74">&#34;org.apache.ofbiz.entity.datasource.GenericHelperDAO&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">schema-name=</span><span style="color:#e6db74">&#34;ofbiz&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">field-type-name=</span><span style="color:#e6db74">&#34;postgres&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">check-on-start=</span><span style="color:#e6db74">&#34;true&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">add-missing-on-start=</span><span style="color:#e6db74">&#34;true&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">use-fk-initially-deferred=</span><span style="color:#e6db74">&#34;false&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">alias-view-columns=</span><span style="color:#e6db74">&#34;false&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">join-style=</span><span style="color:#e6db74">&#34;ansi&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">use-binary-type-for-blob=</span><span style="color:#e6db74">&#34;true&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">use-order-by-nulls=</span><span style="color:#e6db74">&#34;true&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">result-fetch-size=</span><span style="color:#e6db74">&#34;50&#34;</span><span style="color:#f92672">&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&lt;read-data</span> <span style="color:#a6e22e">reader-name=</span><span style="color:#e6db74">&#34;tenant&#34;</span><span style="color:#f92672">/&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&lt;read-data</span> <span style="color:#a6e22e">reader-name=</span><span style="color:#e6db74">&#34;seed&#34;</span><span style="color:#f92672">/&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&lt;read-data</span> <span style="color:#a6e22e">reader-name=</span><span style="color:#e6db74">&#34;seed-initial&#34;</span><span style="color:#f92672">/&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">&lt;/datasource&gt;</span>
</span></span></code></pre></div><p>In the example configuration above, we hid the JDBC URI endpoint — if you perform this on your own cluster, don’t forget to update the <Aurora DSQL_URL> value to reflect your Aurora DSQL cluster endpoint.</p>
<p>We set the jdbc-password value to the special constant IAM_AUTH. OFBiz by default assumes standard password authentication for database connections, but Aurora DSQL requires AWS Identity and Access Management (IAM)–based authentication for a more integrated and secure environment. We add support for this mechanism in the code in the next step.</p>
<p>We also change the isolation level to RepeatableRead (the equivalent PostgreSQL behavior for Aurora DSQL’s snapshot isolation) and increase the minimum pool size (connections in Aurora DSQL are cheap to maintain, but encrypted connection startup is relatively slow). Aurora DSQL only supports encrypted connections, so we add this parameter to the JDBC URI. We also use the latest PG JDBC driver version (42.7.4 at writing) to ensure certified compatibility with Aurora DSQL.</p>
<h3 id="implementing-connection-logic-for-aurora-dsql">Implementing Connection Logic for Aurora DSQL</h3>
<p>There are three key considerations when building connection logic for Aurora DSQL:</p>
<ul>
<li>The actual password is a dynamically generated authentication token, created on demand when IAM authentication is verified.</li>
<li>The authentication token has a limited validity period — they are valid only for a specified time window at creation. This period can be up to one week, suitable for development tools, but for production applications, we recommend a much shorter duration to reduce unauthorized access risks. We chose a 3-hour validity here.</li>
<li>Connections also have a lifetime, currently one hour. The interplay between token validity and connection lifetime can confuse new Aurora DSQL users, so remember the token is only applied when a connection is created (token must be valid at creation), and connection lifetime affects only existing connections (independent of token validity after creation).</li>
</ul>
<p>To support this, we edited the file
framework/entity/src/main/java/org/apache/ofbiz/entity/config/model/EntityConfig.java to add a dedicated authentication flow for Aurora DSQL, adding the following logic:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">static</span> String <span style="color:#a6e22e">getJdbcPassword</span>(InlineJdbc inlineJdbcElement) <span style="color:#66d9ef">throws</span> GenericEntityConfException {
</span></span><span style="display:flex;"><span>    String jdbcPassword <span style="color:#f92672">=</span> inlineJdbcElement.<span style="color:#a6e22e">getJdbcPassword</span>();
</span></span><span style="display:flex;"><span><span style="color:#f92672">+</span>   <span style="color:#66d9ef">if</span> (<span style="color:#f92672">!</span>jdbcPassword.<span style="color:#a6e22e">isEmpty</span>() <span style="color:#f92672">&amp;&amp;</span> <span style="color:#f92672">!</span> jdbcPassword.<span style="color:#a6e22e">equals</span>(<span style="color:#e6db74">&#34;IAM_AUTH&#34;</span>)) {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> jdbcPassword;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span><span style="color:#f92672">+</span>   <span style="color:#66d9ef">if</span> (jdbcPassword.<span style="color:#a6e22e">equals</span>(<span style="color:#e6db74">&#34;IAM_AUTH&#34;</span>)) {
</span></span><span style="display:flex;"><span><span style="color:#f92672">+</span>        <span style="color:#66d9ef">return</span> DSQLAuth.<span style="color:#a6e22e">generateToken</span>(inlineJdbcElement.<span style="color:#a6e22e">getJdbcUri</span>().<span style="color:#a6e22e">split</span>(<span style="color:#e6db74">&#34;/&#34;</span>)<span style="color:#f92672">[</span>2<span style="color:#f92672">]</span>, 
</span></span><span style="display:flex;"><span><span style="color:#f92672">+</span>            Region.<span style="color:#a6e22e">US_EAST_1</span>, 
</span></span></code></pre></div><p>Then, we edited the file
<code>framework/entity/src/main/java/org/apache/ofbiz/entity/connection/DBCPConnectionFactory.java</code>
to use a dedicated ConnectionFactory for Aurora DSQL when the data source is localdsql. We also set the maximum connection lifetime in the pool slightly shorter than Aurora DSQL’s maximum supported connection lifetime.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span>      <span style="color:#75715e">// create the connection factory</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">+</span>        org.<span style="color:#a6e22e">apache</span>.<span style="color:#a6e22e">commons</span>.<span style="color:#a6e22e">dbcp2</span>.<span style="color:#a6e22e">ConnectionFactory</span> cf <span style="color:#f92672">=</span> <span style="color:#66d9ef">null</span>;
</span></span><span style="display:flex;"><span><span style="color:#f92672">+</span>        <span style="color:#66d9ef">if</span> (cacheKey.<span style="color:#a6e22e">equals</span>(<span style="color:#e6db74">&#34;localdsql&#34;</span>)) {
</span></span><span style="display:flex;"><span><span style="color:#f92672">+</span>           cf <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> DSQLConnectionFactory(jdbcDriver, jdbcUri, cfProps);
</span></span><span style="display:flex;"><span><span style="color:#f92672">+</span>        } <span style="color:#66d9ef">else</span> {
</span></span><span style="display:flex;"><span><span style="color:#f92672">+</span>           cf <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> DriverConnectionFactory(jdbcDriver, jdbcUri, cfProps);
</span></span><span style="display:flex;"><span><span style="color:#f92672">+</span>        }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>         <span style="color:#75715e">// wrap it with a LocalXAConnectionFactory</span>
</span></span><span style="display:flex;"><span>         XAConnectionFactory xacf <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> LocalXAConnectionFactory(txMgr, cf);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>         <span style="color:#75715e">// create the pool object factory</span>
</span></span><span style="display:flex;"><span>         PoolableConnectionFactory factory <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> PoolableManagedConnectionFactory(xacf, <span style="color:#66d9ef">null</span>);
</span></span><span style="display:flex;"><span><span style="color:#f92672">+</span>        ((PoolableManagedConnectionFactory)factory).<span style="color:#a6e22e">setMaxConnLifetimeMillis</span>((<span style="color:#66d9ef">long</span>)55<span style="color:#f92672">*</span>60<span style="color:#f92672">*</span>1000);
</span></span><span style="display:flex;"><span>         factory.<span style="color:#a6e22e">setValidationQuery</span>(jdbcElement.<span style="color:#a6e22e">getPoolJdbcTestStmt</span>());
</span></span></code></pre></div><p>Finally, we added core logic to manage connections, including attaching the Aurora DSQL SessionId to connection attributes for better diagnostics. When contacting AWS Support to resolve Aurora DSQL-related issues, providing the Session ID of the specific problematic connection is very helpful.
We implemented the following concrete classes:</p>
<ul>
<li>
<p>framework/entity/src/main/java/org/apache/ofbiz/entity/connection/DSQLAuth.java</p>
</li>
<li>
<p>framework/entity/src/main/java/org/apache/ofbiz/entity/connection/DSQLConnectionFactory.java</p>
</li>
<li>
<p>framework/entity/src/main/java/org/apache/ofbiz/entity/connection/DSQLConnection.java</p>
</li>
</ul>
<h3 id="schema-adjustments">Schema Adjustments</h3>
<p>We made minimal schema changes to comply with current Aurora DSQL limits. Most of the original schema was compatible, but more adjustments could be made if demo data retention were not required (this will be discussed later).
The limitations we worked around relate to supported data types in keys:</p>
<p>NUMERIC type is currently unsupported in keys:</p>
<p>We edited applications/datamodel/entitydef/product-entitymodel.xml, changing the data type of minimumOrderQuantity from fixed-point (NUMERIC(18,6)) to floating-point (float). These two types are not logically identical, but demo data uses decimal. The logic still works correctly here (only “greater than” comparisons used).</p>
<p>We edited framework/entity/fieldtype/fieldtypepostgres.xml to change the <field-type-def type="numeric" sql-type="NUMERIC(20,0)" java-type="Long"/> definition to <field-type-def type="numeric" sql-type="bigint" java-type="Long"/>. Using bigint here is actually more appropriate than NUMERIC(20,0).</p>
<p>VARCHAR is supported in keys, but the maximum size is smaller than normal VARCHAR:</p>
<p>We edited framework/entity/fieldtype/fieldtypepostgres.xml to change the <field-type-def type="email" sql-type="VARCHAR(320)" java-type="String"/> definition to <field-type-def type="email" sql-type="VARCHAR(220)" java-type="String"/>.</p>
<p>After these changes, the schema could be successfully created during data loading (detailed in the next section). We used the -l drop-constraints option in the OFBiz loader utility to ensure no tables were created using foreign key constraints, which are currently unsupported in Aurora DSQL.</p>
<p>As mentioned earlier, we could optimize the schema further. A notable change we avoided was converting ID field data types to UUIDs, common in ORM-based applications. Since we are using demo data, we would need to modify all keys (and references) in the demo data to apply UUID types. Instead, we kept the VARCHAR-based keys and loaded the demo data unchanged.</p>
<h3 id="loading-demo-data">Loading Demo Data</h3>
<p>The OFBiz data loader (see OFBiz Technical Setup Guide) originally performed large numbers of inserts before each commit, causing some transactions to exceed Aurora DSQL’s transaction size limits. To fix this, we edited the storeAll() method in
<code>framework/entity/src/main/java/org/apache/ofbiz/entity/GenericDelegator.java</code>
to batch data loading into groups of 1,000 rows per commit.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>              numberChanged <span style="color:#f92672">+=</span> <span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">store</span>(toStore);
</span></span><span style="display:flex;"><span>                 }
</span></span><span style="display:flex;"><span>             }
</span></span><span style="display:flex;"><span><span style="color:#f92672">+</span>            <span style="color:#75715e">// commit every 1000 rows to conform to DSQL transaction limits</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">+</span>            <span style="color:#66d9ef">if</span> (numberChanged<span style="color:#f92672">%</span>1000 <span style="color:#f92672">==</span> 0) {
</span></span><span style="display:flex;"><span><span style="color:#f92672">+</span>                <span style="color:#66d9ef">if</span> (Debug.<span style="color:#a6e22e">verboseOn</span>()) Debug.<span style="color:#a6e22e">logVerbose</span>(<span style="color:#e6db74">&#34;Committing at 1000 row threshold. beganTransaction=&#34;</span> <span style="color:#f92672">+</span> beganTransaction, module);
</span></span><span style="display:flex;"><span><span style="color:#f92672">+</span>                TransactionUtil.<span style="color:#a6e22e">commit</span>();
</span></span><span style="display:flex;"><span><span style="color:#f92672">+</span>                beganTransaction <span style="color:#f92672">=</span> TransactionUtil.<span style="color:#a6e22e">begin</span>();
</span></span><span style="display:flex;"><span><span style="color:#f92672">+</span>            }
</span></span><span style="display:flex;"><span>         }
</span></span><span style="display:flex;"><span>         TransactionUtil.<span style="color:#a6e22e">commit</span>(beganTransaction);
</span></span><span style="display:flex;"><span>         <span style="color:#66d9ef">return</span> numberChanged;
</span></span></code></pre></div><p><strong>Note:</strong> Aurora DSQL’s actual transaction size limit is larger than 1,000 rows, but we chose this smaller value to observe batching behavior more easily after the change.
We also fixed another interesting bug during lookup. Part of the loading logic calls the findKey() function in
<code>framework/entity/src/main/java/org/apache/ofbiz/entity/util/EntityCrypto.java</code>
to check for the existence of an encryption key in the database. If the key is missing at the expected location, loading stops with an error. When testing with Aurora DSQL, this invariant always triggered. After investigation, we found a general logic bug causing behavior differences between read committed and repeatable read isolation levels. The findKey() method was called without starting a new transaction, so it only saw data as of the current transaction’s snapshot. Since the snapshot was from before the corresponding INSERT committed, findKey() could not see the newly inserted row. Under read committed isolation, the call works fine because the session sees committed data after the transaction start.</p>
<p>To fix this, we start a new transaction whenever findKey() is called:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>GenericValue keyValue <span style="color:#f92672">=</span> <span style="color:#66d9ef">null</span>;
</span></span><span style="display:flex;"><span>     <span style="color:#66d9ef">try</span> {
</span></span><span style="display:flex;"><span><span style="color:#f92672">+</span>        <span style="color:#66d9ef">try</span> {
</span></span><span style="display:flex;"><span><span style="color:#f92672">+</span>            keyValue <span style="color:#f92672">=</span> TransactionUtil.<span style="color:#a6e22e">doNewTransaction</span>(() <span style="color:#f92672">-&gt;</span> {
</span></span><span style="display:flex;"><span><span style="color:#f92672">+</span>                <span style="color:#66d9ef">return</span> EntityQuery.<span style="color:#a6e22e">use</span>(delegator).<span style="color:#a6e22e">from</span>(<span style="color:#e6db74">&#34;EntityKeyStore&#34;</span>).<span style="color:#a6e22e">where</span>(<span style="color:#e6db74">&#34;keyName&#34;</span>, hashedKeyName).<span style="color:#a6e22e">queryOne</span>();
</span></span><span style="display:flex;"><span><span style="color:#f92672">+</span>            }, <span style="color:#e6db74">&#34;checking encrypted key&#34;</span>, 0, <span style="color:#66d9ef">true</span>);
</span></span><span style="display:flex;"><span><span style="color:#f92672">+</span>        } <span style="color:#66d9ef">catch</span> (GenericEntityException e) {
</span></span><span style="display:flex;"><span><span style="color:#f92672">+</span>            <span style="color:#66d9ef">throw</span> <span style="color:#66d9ef">new</span> EntityCryptoException(e);
</span></span><span style="display:flex;"><span><span style="color:#f92672">+</span>        }
</span></span><span style="display:flex;"><span>     } <span style="color:#66d9ef">catch</span> (GenericEntityException e) {
</span></span><span style="display:flex;"><span>         <span style="color:#66d9ef">throw</span> <span style="color:#66d9ef">new</span> EntityCryptoException(e);
</span></span><span style="display:flex;"><span>     }
</span></span></code></pre></div><p>We loaded initial seed and demo data following instructions in the OFBiz Technical Setup Guide.</p>
<p>Handling OCC aborts in transaction command pattern
OFBiz submits transactions to the database using a command pattern — with a Callable interface — simplifying Aurora DSQL transaction handling. Other applications (outside OFBiz) that also encapsulate transactions this way can manage retries similarly because transaction boundaries are clear. For illustration, all we add here is a retry loop around the transaction execution, implemented in
<code>framework/entity/src/main/java/org/apache/ofbiz/entity/transaction/TransactionUtil.java</code> in the InTransaction.call() method.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">protected</span> <span style="color:#a6e22e">InTransaction</span>(Callable<span style="color:#f92672">&lt;</span>V<span style="color:#f92672">&gt;</span> callable, String ifErrorMessage, <span style="color:#66d9ef">int</span> timeout, <span style="color:#66d9ef">boolean</span> printException) {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">callable</span> <span style="color:#f92672">=</span> callable;
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">ifErrorMessage</span> <span style="color:#f92672">=</span> ifErrorMessage;
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">timeout</span> <span style="color:#f92672">=</span> timeout;
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">printException</span> <span style="color:#f92672">=</span> printException;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> V <span style="color:#a6e22e">call</span>() <span style="color:#66d9ef">throws</span> GenericEntityException {
</span></span><span style="display:flex;"><span><span style="color:#f92672">+</span>       <span style="color:#66d9ef">boolean</span> transactionComplete <span style="color:#f92672">=</span> <span style="color:#66d9ef">false</span>;
</span></span><span style="display:flex;"><span><span style="color:#f92672">+</span>       <span style="color:#66d9ef">while</span> (<span style="color:#f92672">!</span>transactionComplete) {
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">boolean</span> tx <span style="color:#f92672">=</span> TransactionUtil.<span style="color:#a6e22e">begin</span>(timeout);
</span></span><span style="display:flex;"><span>            Throwable transactionAbortCause <span style="color:#f92672">=</span> <span style="color:#66d9ef">null</span>;
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">try</span> {
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">try</span> {
</span></span><span style="display:flex;"><span>                    <span style="color:#66d9ef">return</span> callable.<span style="color:#a6e22e">call</span>();
</span></span><span style="display:flex;"><span>                } <span style="color:#66d9ef">catch</span> (Throwable t) {
</span></span><span style="display:flex;"><span>                    <span style="color:#66d9ef">while</span> (t.<span style="color:#a6e22e">getCause</span>() <span style="color:#f92672">!=</span> <span style="color:#66d9ef">null</span>) {
</span></span><span style="display:flex;"><span>                        t <span style="color:#f92672">=</span> t.<span style="color:#a6e22e">getCause</span>();
</span></span><span style="display:flex;"><span>                    }
</span></span><span style="display:flex;"><span>                    <span style="color:#66d9ef">throw</span> t;
</span></span><span style="display:flex;"><span>                }
</span></span><span style="display:flex;"><span>            } <span style="color:#66d9ef">catch</span> (Error <span style="color:#f92672">|</span> RuntimeException e) {
</span></span><span style="display:flex;"><span>                transactionAbortCause <span style="color:#f92672">=</span> e;
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">throw</span> e;
</span></span><span style="display:flex;"><span>            } <span style="color:#66d9ef">catch</span> (Throwable t) {
</span></span><span style="display:flex;"><span>                transactionAbortCause <span style="color:#f92672">=</span> t;
</span></span><span style="display:flex;"><span><span style="color:#f92672">+</span>               <span style="color:#66d9ef">if</span> (t <span style="color:#66d9ef">instanceof</span> SQLException <span style="color:#f92672">&amp;&amp;</span> (((SQLException) t).<span style="color:#a6e22e">getSQLState</span>().<span style="color:#a6e22e">startsWith</span>(<span style="color:#e6db74">&#34;OC&#34;</span>)
</span></span><span style="display:flex;"><span><span style="color:#f92672">+</span>                       <span style="color:#f92672">||</span> ((SQLException) t).<span style="color:#a6e22e">getSQLState</span>().<span style="color:#a6e22e">equals</span>(<span style="color:#e6db74">&#34;40001&#34;</span>))) {
</span></span><span style="display:flex;"><span><span style="color:#f92672">+</span>                   <span style="color:#66d9ef">if</span> (Debug.<span style="color:#a6e22e">verboseOn</span>()) {
</span></span><span style="display:flex;"><span><span style="color:#f92672">+</span>                       Debug.<span style="color:#a6e22e">logVerbose</span>(<span style="color:#e6db74">&#34;Transaction abort, reason: &#34;</span> <span style="color:#f92672">+</span> t, module);
</span></span><span style="display:flex;"><span><span style="color:#f92672">+</span>                       Debug.<span style="color:#a6e22e">logVerbose</span>(<span style="color:#e6db74">&#34;Retrying on OCC conflict&#34;</span>, module);
</span></span><span style="display:flex;"><span><span style="color:#f92672">+</span>                   }
</span></span><span style="display:flex;"><span><span style="color:#f92672">+</span>                   <span style="color:#75715e">// Rollback to recover transaction state and loop again</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">+</span>                   TransactionUtil.<span style="color:#a6e22e">rollback</span>(tx, ifErrorMessage, transactionAbortCause);
</span></span><span style="display:flex;"><span><span style="color:#f92672">+</span>                   <span style="color:#66d9ef">continue</span>;
</span></span><span style="display:flex;"><span><span style="color:#f92672">+</span>               } <span style="color:#66d9ef">else</span> {
</span></span><span style="display:flex;"><span>                    <span style="color:#66d9ef">throw</span> <span style="color:#66d9ef">new</span> GenericEntityException(t);
</span></span><span style="display:flex;"><span><span style="color:#f92672">+</span>               }
</span></span><span style="display:flex;"><span>            } <span style="color:#66d9ef">finally</span> {
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">if</span> (transactionAbortCause <span style="color:#f92672">==</span> <span style="color:#66d9ef">null</span>) {
</span></span><span style="display:flex;"><span>                    TransactionUtil.<span style="color:#a6e22e">commit</span>(tx);
</span></span><span style="display:flex;"><span><span style="color:#f92672">+</span>                   transactionComplete <span style="color:#f92672">=</span> <span style="color:#66d9ef">true</span>;
</span></span><span style="display:flex;"><span>                } <span style="color:#66d9ef">else</span> {
</span></span><span style="display:flex;"><span>                    <span style="color:#66d9ef">if</span> (printException) {
</span></span><span style="display:flex;"><span>                        Debug.<span style="color:#a6e22e">logError</span>(transactionAbortCause, module);
</span></span><span style="display:flex;"><span>                    }
</span></span><span style="display:flex;"><span>                    TransactionUtil.<span style="color:#a6e22e">rollback</span>(tx, ifErrorMessage, transactionAbortCause);
</span></span><span style="display:flex;"><span><span style="color:#f92672">+</span>                   transactionComplete <span style="color:#f92672">=</span> <span style="color:#66d9ef">true</span>;
</span></span><span style="display:flex;"><span><span style="color:#f92672">+</span>               }
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span><span style="color:#f92672">+</span>       <span style="color:#66d9ef">throw</span> <span style="color:#66d9ef">new</span> GenericEntityException(<span style="color:#e6db74">&#34;Unexpected state in transaction handler&#34;</span>);
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p><strong>Note:</strong> For production applications, we also recommend adding exponential backoff and jitter to improve stability under high contention.
Existing applications that do not model transactions this clearly may require deeper analysis to handle OCC aborts properly. We plan to write a future post on this topic after collecting more customer experience data to identify common patterns.</p>
<h2 id="conclusion">Conclusion</h2>
<p>In this article, we guided you through various changes made to a complex existing application. We made minor schema modifications to use supported data types, created new logic to properly interact with Aurora DSQL’s authentication mechanism, implemented batching commits during data loading, and adapted transaction handling to work correctly with OCC semantics.</p>
<p>While this proof of concept focuses more on technical feasibility than production readiness, it demonstrates that Aurora DSQL can support complex database applications like OFBiz with reasonable migration effort. This test confirms that even complex schemas can be adjusted to operate with Aurora DSQL, including improved security and scalability features, through targeted adjustments to authentication, transaction handling, and schema design.
These are also key focus areas when planning your own migrations to Aurora DSQL:</p>
<p>Use supported data types in schemas, including keys</p>
<p>Implement IAM-based authentication logic required by Aurora DSQL</p>
<p>Ensure transaction sizes remain within Aurora DSQL limits</p>
<p>Implement idempotent, retryable transactions</p>
<p>If you are working with existing applications on Aurora DSQL, we invite you to share your experiences and observations in the comments!</p>
<p><strong>About the Author</strong>
James Morle is a Principal Engineer at Amazon Web Services and has been deeply involved in the design and implementation of Aurora DSQL since its inception. He has experience designing and building large-scale databases since the early 1990s.</p>





<footer class=" footline" >
	
</footer>

        
        </div> 
        

      </div>

    <div id="navigation">
        
        
        
        
            
            
                
                    
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                        
                        
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                        
                        
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                        
                        
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
        
        


	 
	 
		
			<a class="nav nav-prev" href="../../3-blogstranslated/3.2-blog2/" title="Blog 2"> <i class="fa fa-chevron-left"></i></a>
		
		
			<a class="nav nav-next" href="../../4-eventparticipated/" title="Events Participated" style="margin-right: 0px;"><i class="fa fa-chevron-right"></i></a>
		
	
    </div>

    </section>
    
    <div style="left: -1000px; overflow: scroll; position: absolute; top: -1000px; border: none; box-sizing: content-box; height: 200px; margin: 0px; padding: 0px; width: 200px;">
      <div style="border: none; box-sizing: content-box; height: 200px; margin: 0px; padding: 0px; width: 200px;"></div>
    </div>
    <script src="../../js/clipboard.min.js?1765277003"></script>
    <script src="../../js/perfect-scrollbar.min.js?1765277003"></script>
    <script src="../../js/perfect-scrollbar.jquery.min.js?1765277003"></script>
    <script src="../../js/jquery.sticky.js?1765277003"></script>
    <script src="../../js/featherlight.min.js?1765277003"></script>
    <script src="../../js/highlight.pack.js?1765277003"></script>
    <script>hljs.initHighlightingOnLoad();</script>
    <script src="../../js/modernizr.custom-3.6.0.js?1765277003"></script>
    <script src="../../js/learn.js?1765277003"></script>
    <script src="../../js/hugo-learn.js?1765277003"></script>

    <link href="../../mermaid/mermaid.css?1765277003" rel="stylesheet" />
    <script src="../../mermaid/mermaid.js?1765277003"></script>
    <script>
        mermaid.initialize({ startOnLoad: true });
    </script>
    <script>
  (function (i, s, o, g, r, a, m) {
    i["GoogleAnalyticsObject"] = r;
    ((i[r] =
      i[r] ||
      function () {
        (i[r].q = i[r].q || []).push(arguments);
      }),
      (i[r].l = 1 * new Date()));
    ((a = s.createElement(o)), (m = s.getElementsByTagName(o)[0]));
    a.async = 1;
    a.src = g;
    m.parentNode.insertBefore(a, m);
  })(
    window,
    document,
    "script",
    "https://www.google-analytics.com/analytics.js",
    "ga",
  );

  ga("create", "UA-158079754-2", "auto");
  ga("send", "pageview");
</script>

  </body>
</html>

